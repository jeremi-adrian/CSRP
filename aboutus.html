				
<!doctype html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang=""> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8" lang=""> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9" lang=""> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang=""> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Wapik About Us Template</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="apple-touch-icon" href="apple-touch-icon.png">

		<link rel="stylesheet" href="fonts/stylesheet.css">
        <link rel="stylesheet" href="css/font-awesome.min.css">
		
        <link rel="stylesheet" href="css/bootstrap.min.css">
        <!--        <link rel="stylesheet" href="assets/css/bootstrap-theme.min.css">-->


        <!--For Plugins external css-->
        <link rel="stylesheet" href="css/plugins.css" />

        <!--Theme custom css -->
        <link rel="stylesheet" href="css/style.css">
        <link rel="stylesheet" href="style.css">

        <!--Theme Responsive css-->
        <link rel="stylesheet" href="css/responsive.css" />

        <script src="assets/js/vendor/modernizr-2.8.3-respond-1.4.2.min.js"></script>
    </head>
    <body>
        <!--[if lt IE 8]>
            <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->
		<div class='preloader'><div class='loaded'>&nbsp;</div></div>
		<header id="header" class="navbar-fixed-top head_bg">
			<div class="container">
				<div class="main_menu">	
					<nav class="navbar navbar-default">
					  <div class="container-fluid">
						<!-- Brand and toggle get grouped for better mobile display -->
						<div class="navbar-header">
						  <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
							<span class="sr-only">Toggle navigation</span>
							<span class="icon-bar"></span>
							<span class="icon-bar"></span>
							<span class="icon-bar"></span>
						  </button>
						  <a class="navbar-brand our_logo" href="#">REGISTRO</a>
							<div class="call_us">
								<!--<i class="fa "></i>--><!-- barra de division -->
							</div>	  
						</div>

						<!-- Collect the nav links, forms, and other content for toggling -->
						<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
						  
						  <ul class="nav navbar-nav navbar-right">
							<li><a href="index.html">Inicio</a></li>
                            <li><a href="">Buscar</a></li>
                            <li><a href="index.html" style="background:#6FB048;
                                color:#fff;border-radius:2px;padding:5px 10px;
                                margin-top:10px;">Registrate</a></li>
							
						</div><!-- /.navbar-collapse  ////  
                        <li><a href="#" style="background:#6FB048;
                            color:#fff;border-radius:2px;padding:5px 10px;
                            margin-top:10px;">Borrar</a></li>
						  </ul>     
                          
                          
                          <form class="navbar-form navbar-left email_sender" role="search">
                                <div class="form-group">
                                    <input type="text" class="form-control" placeholder="Search">
                                </div>
                                <button type="submit" ><i class="fa fa-paper-plane-o"></i></button>
                            </form>
                          
                          
                          
                          -->
					  </div><!-- /.container-fluid -->
					</nav>
					
				</div>
			</div>
		</header>
        <!-- About Us Banner Section -->
		
		<section id="about_banner">
			<div class="about_overlay">
				
			</div>
		</section>

        <!-- Sections -->
		<section id="our_about_area">
			<div class="container">
				<div class="about_top_text text-center">
					<h2>Selecciona tu congregación</h2>
					<div class="separator"></div>
					<p></p>
				</div>
				
				<div class="about_contant_area">
					<div class="row">
						<div class="text-center">
							<div class="col-md-4 col-sm-4 col-xs-12">
								<div class="single_about_text button-like" id="infoButton">
									<img src="img/open-folder.png" alt="Carpeta" />
									<h4>Sierra Papacal</h4>
								</div>
							</div>

							<div id="infoModal" class="modal">
								<div class="modal-content">
									<span class="close">&times;</span>
									<h2>Respuestas del Formulario</h2>
									<div id="responsesContainer">
										<!-- Aquí se mostrarán los nombres de los participantes -->
									</div>
									<button id="clearResponsesButton" style="background-color: brown; color: #ffffff;">Borrar Respuestas</button> <!-- Botón para borrar respuestas -->
									<button id="exportButton" style="background-color: green; color: #ffffff;">Exportar</button> <!-- Botón para exportar -->
								</div>
							</div>
							
							
							<div id="detailsModal" class="modal">
								<div class="modal-content">
									<span class="close">&times;</span>
									<h2>Detalles del Formulario</h2>
									<div id="detailsContainer">
										<!-- Aquí se mostrarán los detalles completos, sin el nombre -->
									</div>
									<button id="backToNamesButton">Regresar</button> <!-- Botón de regreso -->
								</div>
							</div>
							
							

							<div class="col-md-4 col-sm-4 col-xs-12">
								<div class="single_about_text">
									<img src="img/open-folder.png" alt="" />
									<h4>Caucel-anikabil</h4>
									
								</div>
							</div>
							
							<div class="col-md-4 col-sm-4 col-xs-12">
								<div class="single_about_text">
									<img src="img/open-folder.png" alt="" />
									<h4>Progreso</h4>
									
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</section>	


		

        <!-- Sections -->


       


        <!--Footer-->
        <footer id="footer">
            <div class="container">
			
                

                <div class="footer_bottom">
                    <div class="row">
						<div class="col-md-6 col-sm-6 col-xs-12">
							<div class="single_footer_bottom">
							   <p class="wow zoomIn" data-wow-duration="1s">Uso solamente </i>para las congración</a> / Creación (2024). </p>
							</div>
						</div>

						<div class="col-md-6 col-sm-6 col-xs-12">
							<div class="single_footer_bottom pull-right">
								<ul>
									<li><a href="https://walink.co/de04c4" class="s_f_3" style="color: #f9f9f9;"><i class="fa fa-whatsapp"></i></a></li>
									
								</ul>
							</div>
						</div>
					</div>
                </div><!-- End footer bottom -->
            </div>
        </footer>

		<script>
			document.addEventListener('DOMContentLoaded', function() {
				const modal = document.getElementById('infoModal');
				const closeButton = modal.querySelector('.close');
				const responsesContainer = document.getElementById('responsesContainer');
				const infoButton = document.getElementById('infoButton');
				const clearResponsesButton = document.getElementById('clearResponsesButton'); // Botón de borrar respuestas
				const exportButton = document.getElementById('exportButton'); // Botón de exportar
		
				// Obtener la lista de participantes del localStorage
				const participantInfoList = JSON.parse(localStorage.getItem('participantInfoList')) || [];
		
				// Verificar si hay información de participantes
				if (participantInfoList.length > 0) {
					participantInfoList.forEach(participantInfo => {
						const nameElement = document.createElement('div');
						nameElement.textContent = participantInfo.name;
						nameElement.style.cursor = 'pointer';
		
						// Agregar el evento para mostrar más información al hacer clic
						nameElement.addEventListener('click', function() {
							showParticipantDetails(participantInfo); // Mostrar detalles al hacer clic
						});
		
						// Agregar el nombre del participante al contenedor
						responsesContainer.appendChild(nameElement);
					});
				} else {
					responsesContainer.textContent = 'No hay información disponible.'; // Mensaje si no hay información
				}
		
				// Hacer que el infoButton abra el modal
				infoButton.addEventListener('click', function() {
					modal.style.display = "block"; // Muestra el modal
				});
		
				// Cerrar el modal al hacer clic en el botón de cerrar
				closeButton.addEventListener('click', function() {
					modal.style.display = "none"; // Oculta el modal
				});
		
				// Cerrar el modal al hacer clic fuera de él
				window.addEventListener('click', function(event) {
					if (event.target === modal) {
						modal.style.display = "none"; // Oculta el modal
					}
				});
		
				// Lógica para borrar respuestas
				clearResponsesButton.addEventListener('click', function() {
					// Borrar la lista de participantes del localStorage
					localStorage.removeItem('participantInfoList');
					// Limpiar el contenedor de respuestas
					responsesContainer.innerHTML = 'No hay información disponible.'; // Mensaje si no hay información
				});
		
				// Lógica para exportar respuestas
				exportButton.addEventListener('click', function() {
					if (participantInfoList.length === 0) {
						alert("No hay datos para exportar.");
						return;
					}
		
					// Crear un libro de trabajo
					const wb = XLSX.utils.book_new();
		
					// Crear una hoja de datos
					const data = participantInfoList.map(participant => ({
						Nombre: participant.name,
						Roles: Array.isArray(participant.roles) ? participant.roles.join(', ') : participant.roles, // Verifica si es un array
						Congregación: participant.congregacion,
						Participación: participant.participation ? 'Sí' : 'No',
						Publicaciones: participant.publications,
						Videos: participant.videos,
						Horas: participant.hours,
						Revisitas: participant.revisits,
						Cursos: participant.courses,
						Comentarios: participant.comments
						
					}));
		
					const ws = XLSX.utils.json_to_sheet(data);
		
					// Agregar la hoja al libro de trabajo
					XLSX.utils.book_append_sheet(wb, ws, "Respuestas");
		
					// Descargar el archivo
					XLSX.writeFile(wb, "respuestas_formulario.xlsx");
				});
			});
		
			function showParticipantDetails(participantInfo) {
				const detailModal = document.createElement('div'); // Crear un nuevo modal
				detailModal.className = 'modal';
				detailModal.innerHTML = `
					<div class="modal-content">
						<span class="close">&times;</span>
						<h2>Detalles del Participante</h2>
						<p><strong>Congregación:</strong> ${participantInfo.congregacion}</p>
						<p><strong>Comentarios:</strong> ${participantInfo.comments}</p>
						<p><strong>Roles:</strong> ${Array.isArray(participantInfo.roles) ? participantInfo.roles.join(', ') : participantInfo.roles}</p> <!-- Verifica si es un array -->
						<p><strong>Participación en el ministerio:</strong> ${participantInfo.participation ? 'Sí' : 'No'}</p>
						<p><strong>Publicaciones:</strong> ${participantInfo.publications}</p>
						<p><strong>Videos:</strong> ${participantInfo.videos}</p>
						<p><strong>Horas:</strong> ${participantInfo.hours}</p>
						<p><strong>Revisitas:</strong> ${participantInfo.revisits}</p>
						<p><strong>Cursos Bíblicos:</strong> ${participantInfo.courses}</p>
						<button id="backButton">Regresar</button>
					</div>
				`;
		
				document.body.appendChild(detailModal); // Agregar el modal a la página
		
				const closeButton = detailModal.querySelector('.close');
				closeButton.addEventListener('click', function() {
					document.body.removeChild(detailModal); // Eliminar el modal de detalles
				});
		
				const backButton = detailModal.querySelector('#backButton');
				backButton.addEventListener('click', function() {
					document.body.removeChild(detailModal); // Regresar al modal de respuestas
				});
		
				detailModal.style.display = "block"; // Mostrar el modal de detalles
			}
		</script>
		
		
		
		
		
		
			
			
		


        <script src="js/vendor/jquery-1.11.2.min.js"></script>
        <script src="js/vendor/bootstrap.min.js"></script>

        <script src="js/plugins.js"></script>
        <script src="js/main.js"></script>
		<!-- Incluir la biblioteca de xlsx -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>

		

    </body>
</html>	